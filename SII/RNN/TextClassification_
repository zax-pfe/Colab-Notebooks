{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"TextClassification ","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPuvruzlK0JZ5Dh0o/lenT/"},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"af5d05a8c97b4b57b7a7fbf13915343d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c3f47d09b6c9456888909a38c2b00a4d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_bab632c2e5e54033834ffd6db6e6aa5c","IPY_MODEL_88c6e0795847409f9812a115630b2196"]}},"c3f47d09b6c9456888909a38c2b00a4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bab632c2e5e54033834ffd6db6e6aa5c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_03c2ae99ab144fe1969f763f70b2ca75","_dom_classes":[],"description":"Dl Completed...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_10ada89304d74d10a991686acdda0ded"}},"88c6e0795847409f9812a115630b2196":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5dc4517373874451b8b0508e8559dc52","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:02&lt;00:00,  2.39s/ url]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c725102739f74b9395983f90f8026689"}},"03c2ae99ab144fe1969f763f70b2ca75":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"10ada89304d74d10a991686acdda0ded":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5dc4517373874451b8b0508e8559dc52":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c725102739f74b9395983f90f8026689":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a7813aa83bf449488286a32623a75bc4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_165014c4d07f41e4867d26d597fb6662","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_706c5bcb751346ec813a7bbc895f28ab","IPY_MODEL_e282970575b042d2bc9eaa18c0d7813f"]}},"165014c4d07f41e4867d26d597fb6662":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"706c5bcb751346ec813a7bbc895f28ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b761f28669804528bc065784a27cebdc","_dom_classes":[],"description":"Dl Size...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dce5f81b9ff0480daac19289f08efd47"}},"e282970575b042d2bc9eaa18c0d7813f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f9887632da3b4ea4b85ee4f0016b0d19","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 80/80 [00:02&lt;00:00, 33.98 MiB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_561c5d6e3104433e9ef705ba181695c6"}},"b761f28669804528bc065784a27cebdc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"dce5f81b9ff0480daac19289f08efd47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f9887632da3b4ea4b85ee4f0016b0d19":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"561c5d6e3104433e9ef705ba181695c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"247b9445cc624666b58cbada9b2f87b0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b7844733d091484998a1854dd20afc40","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_06b54e874cf246e4a3c00432b27d551b","IPY_MODEL_b80f9f8c857e42d5977969811cecb7d9"]}},"b7844733d091484998a1854dd20afc40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"06b54e874cf246e4a3c00432b27d551b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2697a32fc4ca40c1b3e819e73a1a54ae","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_20d90bd7e1b54f73a06e7067f4a220e3"}},"b80f9f8c857e42d5977969811cecb7d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b44533b56b93482495ac116d651579d1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 25000/0 [00:12&lt;00:00, 3210.93 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_14be7d7ced6341828524268ea775bf46"}},"2697a32fc4ca40c1b3e819e73a1a54ae":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"20d90bd7e1b54f73a06e7067f4a220e3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b44533b56b93482495ac116d651579d1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"14be7d7ced6341828524268ea775bf46":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b68791ec69474468b7c62401bdb1a754":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8e367196a7ca4853a371b78f237e50e4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0c1113e3560d4a439068343f0e4a3b16","IPY_MODEL_7b18d73de8224ffd884bfe8d0f179fda"]}},"8e367196a7ca4853a371b78f237e50e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0c1113e3560d4a439068343f0e4a3b16":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a54ba8605f8e4c619d677acbdba8fbb7","_dom_classes":[],"description":" 53%","_model_name":"FloatProgressModel","bar_style":"danger","max":25000,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":13241,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d778affdf6ee4df4b742df577ec3345a"}},"7b18d73de8224ffd884bfe8d0f179fda":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e6faaec83a254c4cbd631565d37330e8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 13241/25000 [00:00&lt;00:00, 132342.92 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_39af01859c114ed18b0e6519d58cfcfe"}},"a54ba8605f8e4c619d677acbdba8fbb7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d778affdf6ee4df4b742df577ec3345a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e6faaec83a254c4cbd631565d37330e8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"39af01859c114ed18b0e6519d58cfcfe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a8b11f48d9424355860c98cb14a26c55":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8a57a0522dd24b679f1aace9dccd7686","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8217780a66cc48e38a726df2e6b1c5ea","IPY_MODEL_c4d626b8b6db4d9bb9c06301c8c12eca"]}},"8a57a0522dd24b679f1aace9dccd7686":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8217780a66cc48e38a726df2e6b1c5ea":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8e3212cef9c1407f9dae88ddbad0a2cb","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_db01f11677a149d8b95d8b2cc86af5f5"}},"c4d626b8b6db4d9bb9c06301c8c12eca":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fc821a1fa6d54439a374e95b7ab44b29","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 25000/0 [00:12&lt;00:00, 3799.84 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cc3805d174ce44eb97f715c7b3413e9d"}},"8e3212cef9c1407f9dae88ddbad0a2cb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"db01f11677a149d8b95d8b2cc86af5f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fc821a1fa6d54439a374e95b7ab44b29":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cc3805d174ce44eb97f715c7b3413e9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dde82e3ee88047d89b28ed492326efb1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e68b3fd7dbe543ca8e7bf8917935bf9d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b5790111317f4ad7b4cd4c4ae487dfab","IPY_MODEL_bec959e383004718894f4df89621acd8"]}},"e68b3fd7dbe543ca8e7bf8917935bf9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b5790111317f4ad7b4cd4c4ae487dfab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4761a23d40b44af2b2626602fbc97530","_dom_classes":[],"description":" 60%","_model_name":"FloatProgressModel","bar_style":"danger","max":25000,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":15043,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_798902d9130f4bbf86ee4430b68c7b2c"}},"bec959e383004718894f4df89621acd8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_65fad44febb04a6893cc19a5cffc8961","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 15043/25000 [00:00&lt;00:00, 150425.84 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_aff0449f75804a949c4e2e0ff54567fd"}},"4761a23d40b44af2b2626602fbc97530":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"798902d9130f4bbf86ee4430b68c7b2c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"65fad44febb04a6893cc19a5cffc8961":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"aff0449f75804a949c4e2e0ff54567fd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7c60182c26794a409ad7254d54b982e0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0bd93e0dd14a4fefb97319cb64f3b9ea","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a045dcc5bf834961be4f10a9445f3e38","IPY_MODEL_8aeb2fca726e4a66ad90edc7f321f029"]}},"0bd93e0dd14a4fefb97319cb64f3b9ea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a045dcc5bf834961be4f10a9445f3e38":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_529dbb81ac514865b7f0459a477a2d51","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_aca21bdd35314e6b88a761a2cb2cd283"}},"8aeb2fca726e4a66ad90edc7f321f029":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_77fd90f4e41245f8b2d1ad87f9b62ca6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 50000/0 [00:17&lt;00:00, 3956.52 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_08bd1d5fa15e46b880c446716ae59550"}},"529dbb81ac514865b7f0459a477a2d51":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"aca21bdd35314e6b88a761a2cb2cd283":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"77fd90f4e41245f8b2d1ad87f9b62ca6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"08bd1d5fa15e46b880c446716ae59550":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b6f2f485404747898ae6018ff7e1cf02":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d0201868b6ae4f739557e2954d2b7c4f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6afb5a5ff57b45dab24e4d2777012bdb","IPY_MODEL_7cb39ce101f84ecfb896498b3a9fbcfd"]}},"d0201868b6ae4f739557e2954d2b7c4f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6afb5a5ff57b45dab24e4d2777012bdb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_fc02589b1c314cde850e664781935473","_dom_classes":[],"description":" 72%","_model_name":"FloatProgressModel","bar_style":"danger","max":50000,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":35982,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c916765eba9243d98d933d3bc0a89d16"}},"7cb39ce101f84ecfb896498b3a9fbcfd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_8f0e5f5586b548f7a62bcea90afa95fb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 35982/50000 [00:00&lt;00:00, 95973.02 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8f908f2b99a8468587a264f8097fc6fe"}},"fc02589b1c314cde850e664781935473":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c916765eba9243d98d933d3bc0a89d16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8f0e5f5586b548f7a62bcea90afa95fb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8f908f2b99a8468587a264f8097fc6fe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"q6Jbcfk40-k6","executionInfo":{"status":"ok","timestamp":1616065189796,"user_tz":-60,"elapsed":3616,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["pip install -q tensorflow_datasets\r\n"],"execution_count":1,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NPDI5BW8WVJD"},"source":["on importe les bibliotheques :"]},{"cell_type":"code","metadata":{"id":"ugDcCZbwWPX0","executionInfo":{"status":"ok","timestamp":1616065191930,"user_tz":-60,"elapsed":5743,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["import numpy as np\r\n","import tensorflow_datasets as tfds\r\n","import tensorflow as tf \r\n","import pandas as pd\r\n","\r\n","import matplotlib.pyplot as plt"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"9F7JKRktXWvm"},"source":["Fonction d'aide pour tracer des graphiques :"]},{"cell_type":"code","metadata":{"id":"s1xpaUrfWPV9","executionInfo":{"status":"ok","timestamp":1616065191930,"user_tz":-60,"elapsed":5740,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["def plot_graphs(history, metric):\r\n","  plt.plot(history.history[metric])\r\n","  plt.plot(history.history['val_'+metric], ' ')\r\n","  plt.xlabel(\"Epochs\")\r\n","  plt.ylabel(metric)\r\n","  plt.legend([metric,'val_'+metric])"],"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"KEsSSNVeaytV"},"source":["charge le dataset :"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":381,"referenced_widgets":["af5d05a8c97b4b57b7a7fbf13915343d","c3f47d09b6c9456888909a38c2b00a4d","bab632c2e5e54033834ffd6db6e6aa5c","88c6e0795847409f9812a115630b2196","03c2ae99ab144fe1969f763f70b2ca75","10ada89304d74d10a991686acdda0ded","5dc4517373874451b8b0508e8559dc52","c725102739f74b9395983f90f8026689","a7813aa83bf449488286a32623a75bc4","165014c4d07f41e4867d26d597fb6662","706c5bcb751346ec813a7bbc895f28ab","e282970575b042d2bc9eaa18c0d7813f","b761f28669804528bc065784a27cebdc","dce5f81b9ff0480daac19289f08efd47","f9887632da3b4ea4b85ee4f0016b0d19","561c5d6e3104433e9ef705ba181695c6","247b9445cc624666b58cbada9b2f87b0","b7844733d091484998a1854dd20afc40","06b54e874cf246e4a3c00432b27d551b","b80f9f8c857e42d5977969811cecb7d9","2697a32fc4ca40c1b3e819e73a1a54ae","20d90bd7e1b54f73a06e7067f4a220e3","b44533b56b93482495ac116d651579d1","14be7d7ced6341828524268ea775bf46","b68791ec69474468b7c62401bdb1a754","8e367196a7ca4853a371b78f237e50e4","0c1113e3560d4a439068343f0e4a3b16","7b18d73de8224ffd884bfe8d0f179fda","a54ba8605f8e4c619d677acbdba8fbb7","d778affdf6ee4df4b742df577ec3345a","e6faaec83a254c4cbd631565d37330e8","39af01859c114ed18b0e6519d58cfcfe","a8b11f48d9424355860c98cb14a26c55","8a57a0522dd24b679f1aace9dccd7686","8217780a66cc48e38a726df2e6b1c5ea","c4d626b8b6db4d9bb9c06301c8c12eca","8e3212cef9c1407f9dae88ddbad0a2cb","db01f11677a149d8b95d8b2cc86af5f5","fc821a1fa6d54439a374e95b7ab44b29","cc3805d174ce44eb97f715c7b3413e9d","dde82e3ee88047d89b28ed492326efb1","e68b3fd7dbe543ca8e7bf8917935bf9d","b5790111317f4ad7b4cd4c4ae487dfab","bec959e383004718894f4df89621acd8","4761a23d40b44af2b2626602fbc97530","798902d9130f4bbf86ee4430b68c7b2c","65fad44febb04a6893cc19a5cffc8961","aff0449f75804a949c4e2e0ff54567fd","7c60182c26794a409ad7254d54b982e0","0bd93e0dd14a4fefb97319cb64f3b9ea","a045dcc5bf834961be4f10a9445f3e38","8aeb2fca726e4a66ad90edc7f321f029","529dbb81ac514865b7f0459a477a2d51","aca21bdd35314e6b88a761a2cb2cd283","77fd90f4e41245f8b2d1ad87f9b62ca6","08bd1d5fa15e46b880c446716ae59550","b6f2f485404747898ae6018ff7e1cf02","d0201868b6ae4f739557e2954d2b7c4f","6afb5a5ff57b45dab24e4d2777012bdb","7cb39ce101f84ecfb896498b3a9fbcfd","fc02589b1c314cde850e664781935473","c916765eba9243d98d933d3bc0a89d16","8f0e5f5586b548f7a62bcea90afa95fb","8f908f2b99a8468587a264f8097fc6fe"]},"id":"uJgEg1fdWPRk","executionInfo":{"status":"ok","timestamp":1616065242710,"user_tz":-60,"elapsed":56510,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"61fa0c44-165d-46ca-a5f2-f020733030ce"},"source":["dataset, info = tfds.load('imdb_reviews', with_info=True, as_supervised=True)\r\n","\r\n","train_dataset = dataset['train']\r\n","test_dataset = dataset['test']\r\n","train_dataset.element_spec\r\n"],"execution_count":4,"outputs":[{"output_type":"stream","text":["\u001b[1mDownloading and preparing dataset imdb_reviews/plain_text/1.0.0 (download: 80.23 MiB, generated: Unknown size, total: 80.23 MiB) to /root/tensorflow_datasets/imdb_reviews/plain_text/1.0.0...\u001b[0m\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"af5d05a8c97b4b57b7a7fbf13915343d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Completed...', max=1.0, style=Progre…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a7813aa83bf449488286a32623a75bc4","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Size...', max=1.0, style=ProgressSty…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"247b9445cc624666b58cbada9b2f87b0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/imdb_reviews/plain_text/1.0.0.incompleteXW8QCL/imdb_reviews-train.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b68791ec69474468b7c62401bdb1a754","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=25000.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a8b11f48d9424355860c98cb14a26c55","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/imdb_reviews/plain_text/1.0.0.incompleteXW8QCL/imdb_reviews-test.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"dde82e3ee88047d89b28ed492326efb1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=25000.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7c60182c26794a409ad7254d54b982e0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/imdb_reviews/plain_text/1.0.0.incompleteXW8QCL/imdb_reviews-unsupervised.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b6f2f485404747898ae6018ff7e1cf02","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=50000.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["WARNING:absl:Dataset is using deprecated text encoder API which will be removed soon. Please use the plain_text version of the dataset and migrate to `tensorflow_text`.\n"],"name":"stderr"},{"output_type":"stream","text":["\u001b[1mDataset imdb_reviews downloaded and prepared to /root/tensorflow_datasets/imdb_reviews/plain_text/1.0.0. Subsequent calls will reuse this data.\u001b[0m\n","\r"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["(TensorSpec(shape=(), dtype=tf.string, name=None),\n"," TensorSpec(shape=(), dtype=tf.int64, name=None))"]},"metadata":{"tags":[]},"execution_count":4}]},{"cell_type":"markdown","metadata":{"id":"dBBdn_zUs1BE"},"source":["on fait un test pour afficher une critique et le type ( négative ou positive ) de critique ( 0 pour neg et 1 pour pos )"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ssfa6g1jWPPE","executionInfo":{"status":"ok","timestamp":1616065242930,"user_tz":-60,"elapsed":56725,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"16d4e0b4-2f30-48c7-a2a9-5f6b05202b22"},"source":["for example, label in train_dataset.take(1):\r\n","  print('text :', example.numpy())\r\n","  print('label :', label.numpy())\r\n","\r\n"],"execution_count":5,"outputs":[{"output_type":"stream","text":["text : b\"This was an absolutely terrible movie. Don't be lured in by Christopher Walken or Michael Ironside. Both are great actors, but this must simply be their worst role in history. Even their great acting could not redeem this movie's ridiculous storyline. This movie is an early nineties US propaganda piece. The most pathetic scenes were those when the Columbian rebels were making their cases for revolutions. Maria Conchita Alonso appeared phony, and her pseudo-love affair with Walken was nothing but a pathetic emotional plug in a movie that was devoid of any real meaning. I am disappointed that there are movies like this, ruining actor's like Christopher Walken's good name. I could barely sit through it.\"\n","label : 0\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"0lw-Qhxv1JNw"},"source":["on va mélanger les données et creer des paires crique, label\r\n"]},{"cell_type":"code","metadata":{"id":"Dlfq6OhXWPKO","executionInfo":{"status":"ok","timestamp":1616065242931,"user_tz":-60,"elapsed":56725,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["BUFFER_SIZE = 10000\r\n","BATCH_SIZE = 64 #nombre d'example du dataset de test utilisé pour estimer \"l erreur du gradient \" , batch size controle la precision et l'estimation de \"l'erreur du gradient\"\r\n","#il existe un lien entre batch size et la vitesse et stabilité de l'apprentissage "],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"QsKmYDPHWPE8","executionInfo":{"status":"ok","timestamp":1616065242933,"user_tz":-60,"elapsed":56724,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["train_dataset = train_dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE).prefetch(tf.data.AUTOTUNE)\r\n","#shuffle mélange les eements du dataset, pour un bon mélange il faut que la taille du buffer soit >= a la taille du dataset\r\n","#batch va regrouper les element en lots\r\n","#le nombre d'element a pré-lire ( prefetch ) doit etre >= au nombre de lots ( batch ) / AUTOTUNE = -1\r\n","test_dataset = test_dataset.batch(BATCH_SIZE).prefetch(tf.data.AUTOTUNE)\r\n"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"7emntvUBiWQV","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065243586,"user_tz":-60,"elapsed":57376,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"0bd6cd43-449d-456b-e6f7-75a503e0c113"},"source":["for example, label in train_dataset.take(1):\r\n","  print('texts: ', example.numpy()[:3])\r\n","  print()\r\n","  print('labels: ', label.numpy()[:3])"],"execution_count":8,"outputs":[{"output_type":"stream","text":["texts:  [b'\"Ship Ahoy\" was probably made in order to showcase MGM talent. The film is a fun trip on an ocean liner on its way to San Juan, Puerto Rico, at the time in which the country was involved in WWII. This was typical fare for the studios, which gave the movie going public light weight entertainment as a distraction during those difficult times the country was living.<br /><br />The beautiful Eleanor Powell is seen at her best in some musical numbers where she clearly shows us she was a dancer to be reckoned with. Red Skelton is also seen in a straight part with not too much clowning, as he pursues the beautiful Ms. Powell on the ship that is bringing them to Puerto Rico. The irresistible Bert Lahr has good opportunities in the film to show he was a funny man. Also Virginia Grey is seen as a fun girl who is not fooled by anyone.<br /><br />There are good musical numbers featuring Tommy Dorsey and his orchestra, in which one sees, among others, the amazing Buddy Rich, who has a few solos with Mr. Dorsey and Ms. Powell. A young Frank Sinatra appears also as the lead singer of the band, backed by the Pied Pipers.<br /><br />This is a nostalgic trip that should be savored by fans of this genre, which MGM totally controlled.'\n"," b\"I am never a big fan of Taiwan movie production as opposed to Korean, Hongkong or even China. Strong acting quality is hardly found in them as clearly shown in this film. I don't consider myself as hard-to-please audience as I am, in fact, a fan of indie movies. However this movie shows weak plot and slow pace. I found myself lost in the middle as to where the plot is going. The acting certainly does not make it better. Rainie's acting is sub par as she 'over-act', trying to be perky and cute. Although I have to admit she is a pleasure to look at. Isabella Leong on the other hand plays a more suitable role as a confused, sad, regretful, extremely reserved character. Overall I find this movie is a disappointment.\"\n"," b\"Let's keep it simple: My two kids were glued to this movie. It has its flaws from an adult perspective, but buy some jelly-worms and just enjoy it. <br /><br />And the Pepsi girl was excellent!<br /><br />And Kimberly Williams was pretty gosh-darned hot, although she's not in the film very much, so don't get too excited there.<br /><br />Not that's it's really a bad thing, but it is the kind of movie you watch just once. Don't buy the DVD.<br /><br />Enjoy!<br /><br />Did I mention Kimberly Williams? (That was for the dads.)\"]\n","\n","labels:  [1 0 1]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"hyjPETAQ6N2C","executionInfo":{"status":"ok","timestamp":1616065247753,"user_tz":-60,"elapsed":61541,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["VOCAB_SIZE=1000\r\n","encoder = tf.keras.layers.experimental.preprocessing.TextVectorization(\r\n","    max_tokens=VOCAB_SIZE)\r\n","#max_tokens : maximum size of the vocabulary\r\n","encoder.adapt(train_dataset.map(lambda text, label : text))\r\n","\r\n","#la fonction map va modifier la totalité du dataset train\r\n","#manage text in keras model"],"execution_count":9,"outputs":[]},{"cell_type":"code","metadata":{"id":"rsgZUZZE6Nzy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065247756,"user_tz":-60,"elapsed":61542,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"32d1191e-802a-4a71-cb38-cb840d590fdc"},"source":["vocab=np.array(encoder.get_vocabulary())\r\n","vocab[:20]"],"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['', '[UNK]', 'the', 'and', 'a', 'of', 'to', 'is', 'in', 'it', 'i',\n","       'this', 'that', 'br', 'was', 'as', 'for', 'with', 'movie', 'but'],\n","      dtype='<U14')"]},"metadata":{"tags":[]},"execution_count":10}]},{"cell_type":"code","metadata":{"id":"QEx_a5bVgueB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065247757,"user_tz":-60,"elapsed":61542,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"fef740a2-64b4-45ca-b64d-19ba76daad24"},"source":["encoded_example = encoder(example)[:3].numpy()\r\n","encoded_example"],"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[  1,   1,  14, ...,   0,   0,   0],\n","       [ 10, 237, 110, ...,   0,   0,   0],\n","       [599, 382,   9, ...,   0,   0,   0]])"]},"metadata":{"tags":[]},"execution_count":11}]},{"cell_type":"code","metadata":{"id":"sbu1thRJguXQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065247757,"user_tz":-60,"elapsed":61540,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"71c9413f-24a3-4e03-b2f0-e744a70c14c8"},"source":["for n in range(3):\r\n","  print(\"original : \",example[n].numpy())\r\n","  print(\"Round-trip: \",\" \".join(vocab[encoded_example[n]]))\r\n","  print()"],"execution_count":12,"outputs":[{"output_type":"stream","text":["original :  b'\"Ship Ahoy\" was probably made in order to showcase MGM talent. The film is a fun trip on an ocean liner on its way to San Juan, Puerto Rico, at the time in which the country was involved in WWII. This was typical fare for the studios, which gave the movie going public light weight entertainment as a distraction during those difficult times the country was living.<br /><br />The beautiful Eleanor Powell is seen at her best in some musical numbers where she clearly shows us she was a dancer to be reckoned with. Red Skelton is also seen in a straight part with not too much clowning, as he pursues the beautiful Ms. Powell on the ship that is bringing them to Puerto Rico. The irresistible Bert Lahr has good opportunities in the film to show he was a funny man. Also Virginia Grey is seen as a fun girl who is not fooled by anyone.<br /><br />There are good musical numbers featuring Tommy Dorsey and his orchestra, in which one sees, among others, the amazing Buddy Rich, who has a few solos with Mr. Dorsey and Ms. Powell. A young Frank Sinatra appears also as the lead singer of the band, backed by the Pied Pipers.<br /><br />This is a nostalgic trip that should be savored by fans of this genre, which MGM totally controlled.'\n","Round-trip:  [UNK] [UNK] was probably made in order to [UNK] [UNK] talent the film is a fun [UNK] on an [UNK] [UNK] on its way to [UNK] [UNK] [UNK] [UNK] at the time in which the country was involved in [UNK] this was typical [UNK] for the [UNK] which gave the movie going [UNK] light [UNK] entertainment as a [UNK] during those difficult times the country was [UNK] br the beautiful [UNK] [UNK] is seen at her best in some musical [UNK] where she clearly shows us she was a [UNK] to be [UNK] with red [UNK] is also seen in a straight part with not too much [UNK] as he [UNK] the beautiful [UNK] [UNK] on the [UNK] that is [UNK] them to [UNK] [UNK] the [UNK] [UNK] [UNK] has good [UNK] in the film to show he was a funny man also [UNK] [UNK] is seen as a fun girl who is not [UNK] by [UNK] br there are good musical [UNK] [UNK] [UNK] [UNK] and his [UNK] in which one [UNK] among others the amazing [UNK] [UNK] who has a few [UNK] with mr [UNK] and [UNK] [UNK] a young [UNK] [UNK] appears also as the lead [UNK] of the [UNK] [UNK] by the [UNK] [UNK] br this is a [UNK] [UNK] that should be [UNK] by fans of this genre which [UNK] totally [UNK]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n","\n","original :  b\"I am never a big fan of Taiwan movie production as opposed to Korean, Hongkong or even China. Strong acting quality is hardly found in them as clearly shown in this film. I don't consider myself as hard-to-please audience as I am, in fact, a fan of indie movies. However this movie shows weak plot and slow pace. I found myself lost in the middle as to where the plot is going. The acting certainly does not make it better. Rainie's acting is sub par as she 'over-act', trying to be perky and cute. Although I have to admit she is a pleasure to look at. Isabella Leong on the other hand plays a more suitable role as a confused, sad, regretful, extremely reserved character. Overall I find this movie is a disappointment.\"\n","Round-trip:  i am never a big fan of [UNK] movie production as [UNK] to [UNK] [UNK] or even [UNK] strong acting quality is hardly found in them as clearly shown in this film i dont [UNK] myself as [UNK] audience as i am in fact a fan of [UNK] movies however this movie shows weak plot and slow [UNK] i found myself lost in the middle as to where the plot is going the acting certainly does not make it better [UNK] acting is [UNK] [UNK] as she [UNK] trying to be [UNK] and [UNK] although i have to admit she is a [UNK] to look at [UNK] [UNK] on the other hand plays a more [UNK] role as a [UNK] sad [UNK] extremely [UNK] character overall i find this movie is a [UNK]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n","\n","original :  b\"Let's keep it simple: My two kids were glued to this movie. It has its flaws from an adult perspective, but buy some jelly-worms and just enjoy it. <br /><br />And the Pepsi girl was excellent!<br /><br />And Kimberly Williams was pretty gosh-darned hot, although she's not in the film very much, so don't get too excited there.<br /><br />Not that's it's really a bad thing, but it is the kind of movie you watch just once. Don't buy the DVD.<br /><br />Enjoy!<br /><br />Did I mention Kimberly Williams? (That was for the dads.)\"\n","Round-trip:  lets keep it simple my two kids were [UNK] to this movie it has its [UNK] from an [UNK] [UNK] but buy some [UNK] and just enjoy it br br and the [UNK] girl was [UNK] br and [UNK] [UNK] was pretty [UNK] hot although shes not in the film very much so dont get too [UNK] [UNK] br not thats its really a bad thing but it is the kind of movie you watch just once dont buy the [UNK] br [UNK] br did i mention [UNK] [UNK] that was for the [UNK]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"1aljychSguUZ","executionInfo":{"status":"ok","timestamp":1616065247758,"user_tz":-60,"elapsed":61540,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["model = tf.keras.Sequential([\r\n","    encoder,\r\n","    tf.keras.layers.Embedding(\r\n","        input_dim=len(encoder.get_vocabulary()),\r\n","        output_dim=64,\r\n","        # Use masking to handle the variable sequence lengths\r\n","        mask_zero=True),\r\n","    tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(64)),\r\n","    tf.keras.layers.Dense(64, activation='relu'),\r\n","    tf.keras.layers.Dense(1)\r\n","\r\n","])"],"execution_count":13,"outputs":[]},{"cell_type":"code","metadata":{"id":"zJ2xi8iL6NxS","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065247759,"user_tz":-60,"elapsed":61539,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"c7f54ca3-96dc-4ff8-a028-9a998a0bd491"},"source":["print([layer.supports_masking for layer in model.layers])"],"execution_count":14,"outputs":[{"output_type":"stream","text":["[False, True, True, True, True]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"JTfRCjBY1GaN"},"source":["Configuration du modele pour l'entrainement :"]},{"cell_type":"code","metadata":{"id":"yUmsZmMggx-_","executionInfo":{"status":"ok","timestamp":1616065247760,"user_tz":-60,"elapsed":61539,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":["    model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),\r\n","              optimizer=tf.keras.optimizers.Adam(1e-4),\r\n","              metrics=['accuracy'])"],"execution_count":15,"outputs":[]},{"cell_type":"code","metadata":{"id":"aThNhxIhgx8X","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065595722,"user_tz":-60,"elapsed":409498,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"e4c091ea-4585-467b-f045-d3bc883a115a"},"source":["history = model.fit(train_dataset, epochs=10,\r\n","                    validation_data=test_dataset,\r\n","                    validation_steps=30)\r\n"],"execution_count":16,"outputs":[{"output_type":"stream","text":["Epoch 1/10\n","391/391 [==============================] - 71s 84ms/step - loss: 0.6855 - accuracy: 0.5059 - val_loss: 0.5178 - val_accuracy: 0.7198\n","Epoch 2/10\n","391/391 [==============================] - 31s 77ms/step - loss: 0.4747 - accuracy: 0.7569 - val_loss: 0.4095 - val_accuracy: 0.8260\n","Epoch 3/10\n","391/391 [==============================] - 31s 78ms/step - loss: 0.3903 - accuracy: 0.8254 - val_loss: 0.3660 - val_accuracy: 0.8438\n","Epoch 4/10\n","391/391 [==============================] - 31s 78ms/step - loss: 0.3457 - accuracy: 0.8507 - val_loss: 0.3450 - val_accuracy: 0.8484\n","Epoch 5/10\n","391/391 [==============================] - 31s 78ms/step - loss: 0.3216 - accuracy: 0.8636 - val_loss: 0.3343 - val_accuracy: 0.8552\n","Epoch 6/10\n","391/391 [==============================] - 31s 77ms/step - loss: 0.3184 - accuracy: 0.8637 - val_loss: 0.3446 - val_accuracy: 0.8510\n","Epoch 7/10\n","391/391 [==============================] - 31s 78ms/step - loss: 0.3080 - accuracy: 0.8694 - val_loss: 0.3378 - val_accuracy: 0.8557\n","Epoch 8/10\n","391/391 [==============================] - 31s 78ms/step - loss: 0.3040 - accuracy: 0.8716 - val_loss: 0.3274 - val_accuracy: 0.8573\n","Epoch 9/10\n","391/391 [==============================] - 30s 77ms/step - loss: 0.3033 - accuracy: 0.8736 - val_loss: 0.3264 - val_accuracy: 0.8609\n","Epoch 10/10\n","391/391 [==============================] - 31s 77ms/step - loss: 0.2942 - accuracy: 0.8768 - val_loss: 0.3210 - val_accuracy: 0.8562\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Je1aWzg3gx5h","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065610983,"user_tz":-60,"elapsed":424758,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"8c2914f1-f5fe-4581-bcf6-10e752b27cd7"},"source":["test_loss, test_acc = model.evaluate(test_dataset)\r\n","print('test loss : {}'.format(test_loss))\r\n","print('test accuracy : {}'.format(test_acc))\r\n"],"execution_count":17,"outputs":[{"output_type":"stream","text":["391/391 [==============================] - 15s 39ms/step - loss: 0.3167 - accuracy: 0.8566\n","test loss : 0.3167024850845337\n","test accuracy : 0.8565999865531921\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"XqH1YSZuwesq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065613013,"user_tz":-60,"elapsed":426786,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"bc027b9f-11f6-4410-c1b0-b311e48ac525"},"source":["sample_text = ('The movie was cool. The animation and the graphics '\r\n","               'were out of this world. I would recommend this movie.')\r\n","prediction = model.predict(np.array([sample_text]))\r\n","print(prediction[0])\r\n"],"execution_count":18,"outputs":[{"output_type":"stream","text":["[0.72747195]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"B-P0nXHMweqW","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1616065613014,"user_tz":-60,"elapsed":426785,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}},"outputId":"6b4624d7-da10-4e1c-cb00-4fd79ed7fcdc"},"source":["sample_text = ('The movie was bad. The animation and the graphics '\r\n","               'were bad. I would not recommend this movie.')\r\n","predictions = model.predict(np.array([sample_text]))\r\n","print(prediction)"],"execution_count":19,"outputs":[{"output_type":"stream","text":["[[0.72747195]]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"8YRafEet8JD6","executionInfo":{"status":"ok","timestamp":1616065613015,"user_tz":-60,"elapsed":426785,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":[""],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"id":"azp_i1eU8I_Z","executionInfo":{"status":"ok","timestamp":1616065613016,"user_tz":-60,"elapsed":426784,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":[""],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"id":"4tcxXeG-8I9H","executionInfo":{"status":"ok","timestamp":1616065613017,"user_tz":-60,"elapsed":426784,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":[""],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"id":"O1SyZU8z8I6Z","executionInfo":{"status":"ok","timestamp":1616065613018,"user_tz":-60,"elapsed":426783,"user":{"displayName":"Axel Puech","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjBYZ2jCEfVY61tMOjfGATwIpwvX368uNMu2bf4Xg=s64","userId":"01637125792908796850"}}},"source":[""],"execution_count":19,"outputs":[]}]}